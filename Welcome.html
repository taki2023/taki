<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hot Chilli Checkmate - Welcome</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;}

body{
  background:transparent;
  font-family:Arial, Helvetica, sans-serif;
  overflow:hidden;
}

#welcomeBox{
  width:260px;
  padding:12px;
  background:linear-gradient(180deg,#1a1210,#140d0c);
  border-radius:16px;
  display:flex;
  align-items:center;
  gap:10px;
  color:#fff;
  box-shadow:0 0 20px rgba(255,120,60,0.25);
  border:1px solid rgba(255,120,60,0.25);
  animation:fadeIn .6s ease;
}

#welcomeBox img{
  width:42px;
  height:42px;
  border-radius:50%;
  border:2px solid rgba(255,140,80,.6);
}

.text{
  font-size:13px;
  line-height:1.3;
}

.username{
  font-weight:bold;
  color:#ff9a55;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(10px);}
  to{opacity:1; transform:translateY(0);}
}
</style>
</head>

<body>

<div id="welcomeBox">
  Loading latest member...
</div>

<script>
const clubName = "hot-chilli-checkmate";

async function getLatestMember() {
  try {
    const response = await fetch(`https://api.chess.com/pub/club/${clubName}/members`);
    const data = await response.json();

    // Try weekly first (most recent activity), fallback to all_time
    let username = null;

    if (data.weekly && data.weekly.length > 0) {
      username = data.weekly[data.weekly.length - 1];
    } else if (data.all_time && data.all_time.length > 0) {
      username = data.all_time[data.all_time.length - 1];
    }

    if (!username) {
      document.getElementById("welcomeBox").innerHTML = "No members found.";
      return;
    }

    // Get player data (for avatar)
    const playerRes = await fetch(`https://api.chess.com/pub/player/${username}`);
    const playerData = await playerRes.json();

    const avatar = playerData.avatar 
      ? playerData.avatar 
      : "https://images.chesscomfiles.com/uploads/v1/user/0.1/default_avatar.png";

    document.getElementById("welcomeBox").innerHTML = `
      <img src="${avatar}">
      <div class="text">
        ðŸ‘‹ Welcome <span class="username">${username}</span><br>
        to the Chillies Army ðŸ”¥
      </div>
    `;

  } catch (err) {
    document.getElementById("welcomeBox").innerHTML = "Error loading member.";
  }
}

getLatestMember();

// Auto refresh every 5 minutes
setInterval(getLatestMember, 3000);
</script>

</body>
</html>
