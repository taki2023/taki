<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
*{box-sizing:border-box;}
html,body{
  margin:0;
  padding:0;
  background:transparent!important;
  font-family:Inter,Segoe UI,system-ui,sans-serif;
  color:#f1e7df;
  height:100%;
}

#membersBox {
  width: 100%;
  height: auto;  /* changed from 260px */
  padding: 14px 15px;
  background: linear-gradient(180deg, rgba(18,12,10,.92), rgba(10,8,7,.95));
  border: 2.5px solid rgba(255,176,120,.55);
  border-radius: 16px;
  box-shadow: inset 0 0 14px rgba(0,0,0,.55), 0 0 14px rgba(255,176,120,.22);
  display: flex;
  flex-direction: column;
}


/* HEADER */
.membersHeader{
  display:flex;
  align-items:center;
  gap:12px;
  padding:10px 12px;
  border-radius:14px;
  background:linear-gradient(145deg, rgba(255,176,120,.15), rgba(255,138,112,.08));
  border:1.5px solid rgba(255,176,120,.4);
  margin-bottom:8px;
}

.membersIcon{
  width:35px;
  height:35px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:24px;
  background:linear-gradient(145deg,#ffb37a,#ff8a70);
}

.membersTitle{
  font-size:15px;
  font-weight:700;
  letter-spacing:.5px;
}

.membersWelcome{
  font-size:12px;
  margin:6px 6px 12px;
  color:#f1e7df;
  opacity:.95;
}

/* MEMBERS LIST â€” fixed, no scroll */
#membersList{
  flex:1;
  overflow:hidden;
}

/* MEMBER ROW */
.memberRow{
  display:flex;
  align-items:center;
  gap:12px;
  padding:9px 10px;
  border-radius:12px;
  background:rgba(255,176,120,0.06);
  margin-bottom:7px;
  transition:.22s;
  border:1px solid rgba(255,176,120,.12);
}

.memberRow:hover{
  background:rgba(255,176,120,0.22);
  transform:translateY(-2px);
  box-shadow:0 6px 14px rgba(0,0,0,.35);
  border-color:rgba(255,176,120,.35);
}

.memberLink{
  display:flex;
  align-items:center;
  gap:12px;
  text-decoration:none;
  width:100%;
}

/* AVATAR */
.memberAvatar{
  width:44px;
  height:44px;
  border-radius:50%;
  border:2.5px solid rgba(255,176,120,.9);
  box-shadow: 0 0 0 3px rgba(255,176,120,.25), 0 0 12px rgba(255,176,120,.35);
  transition:.25s;
  object-fit:cover;
}

.memberRow:hover .memberAvatar{
  transform:scale(1.06);
  box-shadow: 0 0 0 4px rgba(255,176,120,.35), 0 0 18px rgba(255,176,120,.55);
}

/* TEXT */
.memberText{
  display:flex;
  flex-direction:column;
  min-width:0;
}

.memberName{
  font-size:13px;
  font-weight:800;
  color:#ffb37a;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.memberRating{
  font-size:11.5px;
  color:#ffe7cf;
  opacity:.95;
}

.memberLink:hover .memberName{
  text-decoration:underline;
}
</style>
</head>
<body>
<div id="membersBox">

  <div class="membersHeader">
    <div class="membersIcon">ðŸ”¥</div>
    <div class="membersTitle">Newest Members</div>
  </div>

  <div class="membersWelcome">
    Welcome to the the Chillies Army !
  </div>

  <div id="membersList">
    <!-- placeholders -->
    <div class="memberRow">
      <a class="memberLink">
        <img class="memberAvatar" src="https://taki2023.github.io/taki/default-pawn.png">
        <div class="memberText">
          <div class="memberName">@loading</div>
          <div class="memberRating">â€”: â€”</div>
        </div>
      </a>
    </div>
    <div class="memberRow">
      <a class="memberLink">
        <img class="memberAvatar" src="https://taki2023.github.io/taki/default-pawn.png">
        <div class="memberText">
          <div class="memberName">@loading</div>
          <div class="memberRating">â€”: â€”</div>
        </div>
      </a>
    </div>
    <div class="memberRow">
      <a class="memberLink">
        <img class="memberAvatar" src="https://taki2023.github.io/taki/default-pawn.png">
        <div class="memberText">
          <div class="memberName">@loading</div>
          <div class="memberRating">â€”: â€”</div>
        </div>
      </a>
    </div>
  </div>

</div>

<script>
async function loadNewest() {
  try {
    const r = await fetch("https://api.chess.com/pub/club/hot-chilli-checkmate/members");
    const d = await r.json();
    const members = [...d.weekly, ...d.monthly];
    members.sort((a, b) => b.joined - a.joined);
    const top3 = members.slice(0, 3);

    // Fetch all player data and stats in parallel
    const promises = top3.map(async (m) => {
      const [pj, stats] = await Promise.all([
        fetch("https://api.chess.com/pub/player/" + m.username).then(res => res.json()),
        fetch("https://api.chess.com/pub/player/" + m.username + "/stats").then(res => res.json())
      ]);

      const ratings = [
        {type:"Rapid", value: stats.chess_rapid?.last?.rating},
        {type:"Blitz", value: stats.chess_blitz?.last?.rating},
        {type:"Bullet", value: stats.chess_bullet?.last?.rating},
        {type:"Daily", value: stats.chess_daily?.last?.rating}
      ].filter(x => x.value);

      const best = ratings.length ? ratings.sort((a,b)=>b.value-a.value)[0] : {type:"â€”", value:"â€”"};
      const avatar = pj.avatar || "https://taki2023.github.io/taki/default-pawn.png";

      return {
        username: m.username,
        avatar,
        ratingType: best.type,
        ratingValue: best.value
      };
    });

    const membersData = await Promise.all(promises);

    // Build all rows in one go
    const box = document.getElementById("membersList");
    box.innerHTML = membersData.map(m => `
      <div class="memberRow">
        <a class="memberLink" href="https://www.chess.com/member/${m.username}" target="_blank">
          <img class="memberAvatar" src="${m.avatar}">
          <div class="memberText">
            <div class="memberName">@${m.username}</div>
            <div class="memberRating">${m.ratingType}: ${m.ratingValue}</div>
          </div>
        </a>
      </div>
    `).join("");

  } catch (err) {
    console.error(err);
    document.getElementById("membersList").innerHTML = "Unable to load members.";
  }
}

window.addEventListener("DOMContentLoaded", loadNewest);
</script>

</body>
</html>
