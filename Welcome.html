<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<style>
*{box-sizing:border-box;}
html,body{
  margin:0;
  padding:0;
  height:100%;
  background:transparent!important;
  font-family:Inter,Segoe UI,system-ui,sans-serif;
  color:#ffffff;
}

/* MAIN BOX â€” FLEX HEIGHT SAFE */
#membersBox{
  width:100%;
  height:100%;
  padding:12px 14px;
  display:flex;
  flex-direction:column;

  background:linear-gradient(180deg,rgba(18,12,10,.92),rgba(10,8,7,.95));
  border:2.5px solid rgba(255,176,120,.55);
  border-radius:16px;

  box-shadow:
    inset 0 0 14px rgba(0,0,0,.55),
    0 0 14px rgba(255,176,120,.22);
}

.membersHeader{
  display:flex;
  align-items:center;
  gap:12px;
  padding:10px 12px;
  border-radius:14px;
  background:linear-gradient(145deg,
      rgba(255,176,120,.15),
      rgba(255,138,112,.08)
  );
  border:1.5px solid rgba(255,176,120,.4);
  margin-bottom:8px;
}

.membersIcon{
  width:40px;
  height:40px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:22px;
  background:linear-gradient(145deg,#ffb37a,#ff8a70);
}

.membersTitle{
  font-size:15px;
  font-weight:600;
  letter-spacing:.5px;
  color:#ffffff;
}

/* SIMPLE WELCOME TEXT â€” NO BOX */
.membersWelcome{
  font-size:12px;
  line-height:1.35;
  margin:6px 6px 10px;
  color:#ffffff;
  opacity:.95;
}

/* LIST AREA â€” AUTO FIT HEIGHT */
#membersList{
  overflow:auto;
  flex:1;
}

/* MEMBER ROW */
.memberRow{
  display:flex;
  align-items:center;
  gap:10px;
  padding:7px 8px;
  border-radius:10px;
  background:rgba(255,176,120,0.06);
  margin-bottom:6px;
  transition:.18s;
}

.memberRow:hover{
  background:rgba(255,176,120,0.18);
}

.memberLink{
  display:flex;
  align-items:center;
  gap:10px;
  text-decoration:none;
  width:100%;
}

.memberAvatar{
  width:34px;
  height:34px;
  border-radius:50%;
  border:1.5px solid rgba(255,176,120,.6);
  box-shadow:0 0 8px rgba(255,176,120,.25);
}

.memberText{
  display:flex;
  flex-direction:column;
  min-width:0;
}

.memberName{
  font-size:13px;
  font-weight:700;
  color:#ffffff;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.memberRating{
  font-size:11px;
  color:#ffffff;
  opacity:.9;
}

.memberLink:hover .memberName{
  text-decoration:underline;
}
</style>
</head>

<body>

<div id="membersBox">

  <div class="membersHeader">
    <div class="membersIcon">ðŸ”¥</div>
    <div class="membersTitle">Newest Members</div>
  </div>

  <div class="membersWelcome">
    Welcome and thanks for joining the Chillies Army.
  </div>

  <div id="membersList">Loading...</div>

</div>

<script>
async function loadNewest(){

  const r = await fetch("https://api.chess.com/pub/club/hot-chilli-checkmate/members");
  const d = await r.json();

  const members = [...d.weekly, ...d.monthly];
  members.sort((a,b)=> b.joined - a.joined);
  const top3 = members.slice(0,3);

  const box = document.getElementById("membersList");
  box.innerHTML = "";

  for(const m of top3){

    const pr = await fetch("https://api.chess.com/pub/player/" + m.username);
    const pj = await pr.json();

    const statsR = await fetch("https://api.chess.com/pub/player/" + m.username + "/stats");
    const stats = await statsR.json();

    const ratings = [
      {type:"Rapid",  value: stats.chess_rapid?.last?.rating},
      {type:"Blitz",  value: stats.chess_blitz?.last?.rating},
      {type:"Bullet", value: stats.chess_bullet?.last?.rating},
      {type:"Daily",  value: stats.chess_daily?.last?.rating}
    ].filter(x => x.value);

    let best = {type:"â€”", value:"â€”"};
    if(ratings.length){
      best = ratings.sort((a,b)=>b.value-a.value)[0];
    }

    const avatar =
      pj.avatar ||
      "https://taki2023.github.io/taki/default-pawn.png";

    const row = document.createElement("div");
    row.className = "memberRow";

    row.innerHTML = `
      <a class="memberLink"
         href="https://www.chess.com/member/${m.username}"
         target="_blank">

        <img class="memberAvatar" src="${avatar}">
        
        <div class="memberText">
          <div class="memberName">@${m.username}</div>
          <div class="memberRating">${best.type}: ${best.value}</div>
        </div>

      </a>
    `;

    box.appendChild(row);
  }
}

loadNewest();
</script>

</body>
</html>
