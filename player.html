<style>
/* Ensure all widths include padding and borders */
* { box-sizing: border-box; }

html, body {
    margin: 0;
    padding: 0;
    background: transparent !important; /* keep page fully transparent */
    width: 100%;
    height: 100%;
    overflow: hidden;
}

/* Music Player Container styled like sidebar */
#playerBox {
    width: 100%;
    margin: 0;
    padding: 12px 10px;
    border-radius: 16px;
    background: rgba(0, 0, 0, 0.40); /* dark translucent like sidebar */
    border: 2px solid rgba(255,176,120,0.45); /* golden outline */
    box-shadow: rgba(0, 0, 0, 0.25) 0 0 10px inset;
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    text-align: center;
}

/* Bars styled to match sidebar theme */
#progressBar, #volumeBar {
    background: rgba(255, 255, 255, 0.08); /* subtle overlay */
    border-radius: 8px;
    position: relative;
}

#progressFilled, #volumeFill {
    border-radius: 8px;
    background: linear-gradient(90deg, #ffb37a, #ff8a70); /* golden-orange gradient */
    box-shadow: inset 0 0 6px rgba(255,176,120,0.5);
}

/* Knobs */
#progressKnob, #volumeKnob {
    box-shadow: 0 0 6px rgba(255,176,120,0.9);
    background: #ffe2c4;
}

/* Buttons (play/pause, loop, mute) */
#playPauseBtn, #loopBtn, #cutIcon {
    border: none;
    cursor: pointer;
}
</style>

<!-- üéµ Transparent Music Player -->
<div id="playerBox">

  <!-- TOP CONTROLS -->
  <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;">

    <button id="playPauseBtn" style="
      width:32px;height:32px;border-radius:50%;
      background:linear-gradient(145deg,#ffb37a,#ff8a70);
      border:none;cursor:pointer;font-size:14px;
      box-shadow:0 0 8px rgba(255,176,120,0.55);
    ">‚ñ∂</button>

    <!-- PROGRESS BAR -->
    <div id="progressBar" style="
      flex:1;
      height:8px;
      border-radius:8px;
      position:relative;
      cursor:pointer;
    ">
      <div id="progressFilled" style="
        height:100%;
        width:0%;
        background:linear-gradient(90deg,#ffb37a,#ff8a70);
        border-radius:8px;
        position:relative;
      ">
        <div id="progressKnob" style="
          position:absolute;
          right:-6px;
          top:50%;
          transform:translateY(-50%);
          width:12px;height:12px;
          border-radius:50%;
          background:#ffe2c4;
          box-shadow:0 0 6px rgba(255,176,120,0.9);
        "></div>
      </div>
    </div>

    <button id="loopBtn" style="
      width:30px;height:30px;border-radius:50%;
      background:rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.15);
      cursor:pointer;font-size:14px;color:#fff;
    ">üîÅ</button>

    <div id="timeDisplay" style="
      min-width:80px;
      font-size:14px;
      font-weight:600;
      color:#fff;
      text-align:right;
    ">0:00 / 0:00</div>

  </div>

  <!-- VOLUME -->
  <div style="display:flex;align-items:center;justify-content:center;gap:6px;">
    <span id="cutIcon" style="font-size:16px;cursor:pointer;">üîä</span>

    <div id="volumeBar" style="
      position:relative;
      width:100px;height:6px;
      border-radius:6px;
      cursor:pointer;
    ">
      <div id="volumeFill" style="
        position:absolute;height:100%;
        width:70%;
        background:linear-gradient(90deg,#7b4dff,#b388ff,#d1b3ff);
        border-radius:6px;
      "></div>
      <div id="volumeKnob" style="
        position:absolute;
        top:-5px;
        left:70%;
        width:3px;height:16px;
        background:#e9ddff;
        box-shadow:0 0 6px rgba(180,140,255,0.9);
      "></div>
    </div>
  </div>

  <audio id="audioPlayer" style="display:none" src="https://cs1.mp3.pm/download/196179361/M0wyQ0lNU3lsSmcrcWVXSFZhSTFtTmZPTm9GL1VtLzMwNXNaZkpWU1FsTGdEcTNxcVFxVjd0dE1uM0dDdkx6Y0lxWk5tRDZqME5uR0NZa1NKeURsdTJZOTB1RVY3bFJlRWJ3UysyMXIvd0pvT21IY2doQ3UycWppcC9hYnc1Uzc/8D_TOP_MUSIC_-_Alan_Walker_-_Faded_(mp3.pm).mp3"></audio>
</div>

<script>
const audio = document.getElementById('audioPlayer');
const playBtn = document.getElementById('playPauseBtn');
const cutIcon = document.getElementById('cutIcon');
const progressBar = document.getElementById('progressBar');
const progressFilled = document.getElementById('progressFilled');
const volumeBar = document.getElementById('volumeBar');
const volumeFill = document.getElementById('volumeFill');
const volumeKnob = document.getElementById('volumeKnob');
const timeDisplay = document.getElementById('timeDisplay');

let draggingVolume = false;

/* LOAD MEMORY */
let savedVolume = parseFloat(localStorage.getItem('musicVolume'));
let savedTime = parseFloat(localStorage.getItem('musicTime'));
let savedMuted = localStorage.getItem('musicMuted') === 'true';

audio.volume = isNaN(savedVolume) ? 0.7 : savedVolume;
audio.muted = savedMuted;
if(!isNaN(savedTime)) audio.currentTime = savedTime;

/* ICON */
function updateIcon(){
  cutIcon.textContent = (audio.muted || audio.volume === 0) ? 'üîá' : 'üîä';
}

/* VOLUME UI */
function setVolume(v){
  v = Math.max(0, Math.min(1, v));
  audio.volume = v;
  audio.muted = false;
  volumeFill.style.width = (v*100)+'%';
  volumeKnob.style.left = (v*100)+'%';
  localStorage.setItem('musicVolume', v);
  localStorage.setItem('musicMuted', false);
  updateIcon();
}

/* INIT UI */
volumeFill.style.width = (audio.volume*100)+'%';
volumeKnob.style.left = (audio.volume*100)+'%';
updateIcon();

/* PLAY */
playBtn.onclick = () => audio.paused ? audio.play() : audio.pause();
audio.onplay = audio.onpause = () => playBtn.textContent = audio.paused ? '‚ñ∂' : '‚ùö‚ùö';

/* MUTE */
cutIcon.onclick = () => {
  audio.muted = !audio.muted;
  localStorage.setItem('musicMuted', audio.muted);
  if(audio.muted){
    volumeFill.style.width = '0%';
    volumeKnob.style.left = '0%';
  } else {
    setVolume(audio.volume || 0.7);
  }
  updateIcon();
};

/* CLICK & DRAG VOLUME */
volumeBar.addEventListener('mousedown', e => {
  draggingVolume = true;
  setVolume((e.offsetX) / volumeBar.offsetWidth);
});
document.addEventListener('mouseup', () => draggingVolume = false);
document.addEventListener('mousemove', e => {
  if(!draggingVolume) return;
  const rect = volumeBar.getBoundingClientRect();
  setVolume((e.clientX - rect.left) / rect.width);
});
volumeBar.addEventListener('click', e => {
  const rect = volumeBar.getBoundingClientRect();
  setVolume((e.clientX - rect.left) / rect.width);
});

/* FORMAT TIME */
function formatTime(s){
  const m = Math.floor(s/60);
  const sec = Math.floor(s%60);
  return m + ':' + (sec<10 ? '0' : '') + sec;
}

/* UPDATE PROGRESS */
audio.addEventListener('timeupdate', () => {
  const pct = (audio.currentTime / (audio.duration || 1)) * 100;
  progressFilled.style.width = pct + '%';
  timeDisplay.textContent = formatTime(audio.currentTime) + ' / ' + formatTime(audio.duration || 0);
  localStorage.setItem('musicTime', audio.currentTime);
});

/* CLICK PROGRESS BAR */
progressBar.addEventListener('click', e => {
  const rect = progressBar.getBoundingClientRect();
  audio.currentTime = ((e.clientX - rect.left) / rect.width) * audio.duration;
});
</script>
