<!-- ğŸµ ELEGANT SIDEBAR MUSIC PLAYER -->
<div style="
width:92%;
margin:0 auto;
background:linear-gradient(180deg, rgba(25,18,15,0.55), rgba(15,10,8,0.65));
border-radius:18px;
padding:14px;
border:1.5px solid rgba(255,176,120,0.35);
box-shadow:0 0 18px rgba(0,0,0,.35), inset 0 0 12px rgba(0,0,0,.25);
text-align:center;
backdrop-filter:blur(6px);
" id="playerBox">

  <!-- TOP CONTROLS -->
  <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px;">

    <!-- Play -->
    <button id="playPauseBtn" style="
    width:38px;height:38px;border-radius:50%;
    background:linear-gradient(145deg,#ffb37a,#ff8a70);
    border:none;cursor:pointer;font-size:15px;
    box-shadow:0 0 12px rgba(255,176,120,0.55);
    ">â–¶</button>

    <!-- Progress -->
    <div id="progressBar" style="
    flex:1;height:12px;background:rgba(40,25,20,0.6);
    border-radius:10px;position:relative;cursor:pointer;overflow:hidden;
    ">
      <div id="progressFilled" style="
      height:100%;width:0%;
      background:linear-gradient(90deg,#ffb37a,#ff8a70);
      border-radius:10px;"></div>
    </div>

    <!-- LOOP AFTER BAR -->
    <button id="loopBtn" title="Loop" style="
    width:36px;height:36px;border-radius:50%;
    background:rgba(255,255,255,0.08);
    border:1px solid rgba(255,255,255,0.15);
    cursor:pointer;font-size:15px;color:#fff;
    ">ğŸ”</button>

    <!-- BIG TIMER -->
    <div id="timeDisplay" style="
    min-width:110px;
    font-size:18px;
    font-family:Arial, sans-serif;
    font-weight:700;
    color:#ffffff;
    text-align:right;
    ">0:00 / 0:00</div>

  </div>

  <!-- VOLUME / CUT -->
  <div style="display:flex; align-items:center; justify-content:center; gap:8px;">
    <span id="cutIcon" style="color:#caa6ff;font-size:18px;cursor:pointer;">ğŸ”Š</span>

    <div style="position:relative;width:100px;height:6px;background:rgba(40,25,20,0.6);border-radius:6px;overflow:hidden;">
      <div id="volumeFill" style="
      position:absolute;height:100%;width:70%;
      background:linear-gradient(90deg,#7b4dff,#b388ff,#d1b3ff);
      "></div>
      <input id="volumeControl" type="range" min="0" max="1" step="0.01" value="0.7"
      style="position:absolute;width:100%;height:100%;opacity:0;cursor:pointer;">
    </div>
  </div>

  <audio id="audioPlayer"
  src="https://cs1.mp3.pm/download/196179361/M0wyQ0lNU3lsSmcrcWVXSFZhSTFtTmZPTm9GL1VtLzMwNXNaZkpWU1FsTGdEcTNxcVFxVjd0dE1uM0dDdkx6Y0lxWk5tRDZqME5uR0NZa1NKeURsdTJZOTB1RVY3bFJlRWJ3UysyMXIvd0pvT21IY2doQ3UycWppcC9hYnc1Uzc/8D_TOP_MUSIC_-_Alan_Walker_-_Faded_(mp3.pm).mp3">
  </audio>
</div>

<script>
const audio = document.getElementById('audioPlayer');
const playBtn = document.getElementById('playPauseBtn');
const loopBtn = document.getElementById('loopBtn');
const cutIcon = document.getElementById('cutIcon');
const progressFilled = document.getElementById('progressFilled');
const progressBar = document.getElementById('progressBar');
const volumeControl = document.getElementById('volumeControl');
const volumeFill = document.getElementById('volumeFill');
const timeDisplay = document.getElementById('timeDisplay');

/* Memory */
let savedVolume = localStorage.getItem('musicVolume') ?? 0.7;
let savedTime = localStorage.getItem('musicTime') ?? 0;
let savedMute = localStorage.getItem('musicMuted') === 'true';
let lastVolume = savedVolume; // remember previous volume for mute/unmute

audio.volume = savedVolume;
volumeControl.value = savedVolume;
volumeFill.style.width = (savedVolume*100)+'%';

if(savedMute){
  audio.muted = true;
  cutIcon.textContent = 'ğŸ”‡';
} else {
  audio.muted = false;
  cutIcon.textContent = 'ğŸ”Š';
}

/* Loaded metadata */
audio.addEventListener('loadedmetadata',()=>{
  if(savedTime && savedTime < audio.duration) audio.currentTime = savedTime;
  updateTimer();
});

/* Format time */
function formatTime(s){
  const m = Math.floor(s/60);
  const sec = Math.floor(s%60);
  return m+':'+(sec<10?'0':'')+sec;
}

/* Update timer and progress */
function updateTimer(){
  timeDisplay.textContent = formatTime(audio.currentTime)+' / '+formatTime(audio.duration);
  progressFilled.style.width = (audio.currentTime/audio.duration*100)+'%';
  localStorage.setItem('musicTime', audio.currentTime);
}

/* Update play button symbol */
function updatePlayButton(){
  playBtn.textContent = audio.paused ? 'â–¶' : 'âšâš';
}

/* Play/Pause */
playBtn.onclick = () => {
  if(audio.paused) audio.play();
  else audio.pause();
  updatePlayButton();
};

/* Update button on play/pause events */
audio.addEventListener('play', updatePlayButton);
audio.addEventListener('pause', updatePlayButton);

/* LOOP */
loopBtn.onclick = () => {
  audio.loop = !audio.loop;
  loopBtn.style.background = audio.loop ? "rgba(150,100,255,0.35)" : "rgba(255,255,255,0.08)";
};

/* CUT / Mute with memory of last volume */
cutIcon.onclick = () => {
  if(!audio.muted){ 
    // Mute: store current volume, set volume to 0 visually
    lastVolume = audio.volume;
    audio.muted = true;
    volumeFill.style.width = '0%';
    cutIcon.textContent = 'ğŸ”‡';
  } else {
    // Unmute: restore previous volume
    audio.muted = false;
    audio.volume = lastVolume;
    volumeFill.style.width = (lastVolume*100)+'%';
    cutIcon.textContent = 'ğŸ”Š';
  }
  localStorage.setItem('musicMuted', audio.muted);
  localStorage.setItem('musicVolume', audio.volume);
};

/* Seek */
progressBar.onclick = (e) => {
  const r = progressBar.getBoundingClientRect();
  audio.currentTime = ((e.clientX - r.left)/r.width) * audio.duration;
};

/* Volume */
volumeControl.oninput = (e) => {
  audio.volume = e.target.value;
  volumeFill.style.width = (e.target.value*100)+'%';
  lastVolume = e.target.value; // update lastVolume for mute/unmute
  localStorage.setItem('musicVolume', e.target.value);
};

/* Update timer continuously */
audio.ontimeupdate = updateTimer;
</script>
