<style>
*{box-sizing:border-box}
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:transparent!important;
  overflow:hidden;
}

/* PLAYER */
#playerBox{
  width:100%;
  padding:10px 12px;
  background:linear-gradient(180deg,rgba(18,12,10,.92),rgba(10,8,7,.95));
  border:2.5px solid rgba(255,176,120,.55);
  border-radius:16px;
  box-shadow:inset 0 0 14px rgba(0,0,0,.55),0 0 14px rgba(255,176,120,.22);
}

/* PLAYLIST */
#playlistContainer{
  margin-top:8px;
  max-height:140px;
  overflow-y:auto;
  padding-right:6px;
}

.playlistItem{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
  cursor:pointer;
  padding:6px 10px;
  border-radius:8px;
  margin-bottom:4px;
  font-size:12px;
  font-family:Segoe UI,sans-serif;
  color:#f1e7df;
  background:rgba(255,176,120,0.06);
  transition:background .18s, transform .15s, box-shadow .15s;
  user-select:none;
}

.playlistItem:hover{
  background:rgba(255,176,120,0.16);
  transform:translateX(2px);
}

.playlistItem.active{
  background:linear-gradient(
    90deg,
    rgba(255,176,120,.35),
    rgba(255,176,120,.15)
  );
  box-shadow:inset 0 0 10px rgba(255,176,120,.25);
}

/* left side */
.playLeft{
  display:flex;
  align-items:center;
  gap:8px;
  min-width:0;
}

.playIndex{
  font-size:12px;
  min-width:20px;
  text-align:right;
  opacity:.7;
}

.playIndex.active{
  opacity:1;
  font-weight:700;
}

.playTitle{
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* right side */
.playTime{
  font-size:11px;
  opacity:.6;
}

.playTime.active{
  font-weight:700;
  opacity:1;
}
</style>

<div id="playerBox">
  <div id="playlistContainer"></div>
  <audio id="audioPlayer"></audio>
</div>

<script>
const audio = document.getElementById('audioPlayer');
const playlistContainer = document.getElementById('playlistContainer');

let playlist = JSON.parse(localStorage.getItem('musicPlaylist')) || [
  { title: "Faded - Alan Walker", src: "https://cs1.mp3.pm/download/196179361/M0wyQ0lNU3lsSmcrcWVXSFZhSTFtTmZPTm9GL1VtLzMwNXNaZkpWU1FsTGdEcTNxcVFxVjd0dE1uM0dDdkx6Y0lxWk5tRDZqME5uR0NZa1NKeURsdTJZOTB1RVY3bFJlRWJ3UysyMXIvd0pvT21IY2doQ3UycWppcC9hYnc1Uzc/8D_TOP_MUSIC_-_Alan_Walker_-_Faded_(mp3.pm).mp3" },
  { title: "Song Two", src: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" },
  { title: "Song Three", src: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3" }
];

let currentTrack = parseInt(localStorage.getItem('musicCurrentTrack')) || 0;

/* FORMAT TIME */
function fmt(s){
  const m=Math.floor(s/60);
  const sec=Math.floor(s%60);
  return m+':'+(sec<10?'0':'')+sec;
}

/* LOAD DURATION */
function loadTrackDuration(i){
  if(playlist[i].duration) return;

  const a = new Audio();
  a.src = playlist[i].src;
  a.addEventListener('loadedmetadata', ()=>{
    playlist[i].duration = fmt(a.duration);
    localStorage.setItem('musicPlaylist', JSON.stringify(playlist));
    updatePlaylistUI();
  });
}

/* PLAY TRACK */
function loadTrack(i){
  currentTrack = i;
  audio.src = playlist[i].src;
  audio.play();
  updatePlaylistUI();
  localStorage.setItem('musicCurrentTrack', currentTrack);
}

/* UI */
function updatePlaylistUI(){
  playlistContainer.innerHTML = '';

  playlist.forEach((track,i)=>{
    loadTrackDuration(i);

    const item = document.createElement('div');
    item.className = 'playlistItem' + (i===currentTrack?' active':'');

    const left = document.createElement('div');
    left.className = 'playLeft';

    const index = document.createElement('div');
    index.className = 'playIndex' + (i===currentTrack?' active':'');
    index.textContent =
      i===currentTrack
        ? (audio.paused ? '▶' : '❚❚')
        : String(i+1).padStart(2,'0');

    const title = document.createElement('div');
    title.className = 'playTitle';
    title.textContent = track.title;

    left.appendChild(index);
    left.appendChild(title);

    const time = document.createElement('div');
    time.className = 'playTime' + (i===currentTrack?' active':'');
    time.textContent = track.duration || '--:--';

    item.appendChild(left);
    item.appendChild(time);

    item.onclick = ()=> loadTrack(i);

    playlistContainer.appendChild(item);
  });
}

/* AUDIO EVENTS */
audio.onplay = updatePlaylistUI;
audio.onpause = updatePlaylistUI;
audio.onended = ()=>{
  currentTrack = (currentTrack+1)%playlist.length;
  loadTrack(currentTrack);
};

/* INIT */
loadTrack(currentTrack);
</script>
