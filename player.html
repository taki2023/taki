<style>
*{box-sizing:border-box}

html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:transparent!important;
  overflow:hidden;
}

/* ================= PLAYER ================= */
#playerBox{
  width:100%;
  height:100%;
  padding:10px 12px;
  background:linear-gradient(180deg,rgba(18,12,10,.92),rgba(10,8,7,.95))!important;
  border:2.5px solid rgba(255,176,120,.55);
  border-radius:16px;
  box-shadow:inset 0 0 14px rgba(0,0,0,.55),0 0 14px rgba(255,176,120,.22);
}

/* ================= BARS ================= */
#progressBar,#volumeBar{
  background:linear-gradient(180deg,#1a120f,#120a08)!important;
  border-radius:10px;
  border:1.8px solid rgba(255,176,120,.45);
  box-shadow:inset 0 0 8px rgba(0,0,0,.6),0 0 8px rgba(255,176,120,.15);
  position:relative;
  cursor:pointer;
}

/* ================= FILLS ================= */
#progressFilled{
  height:100%;
  background:linear-gradient(90deg,#ffb37a,#ff8a70);
  border-radius:10px;
  box-shadow:inset 0 0 8px rgba(255,170,130,.75),0 0 10px rgba(255,154,106,.55);
}

#volumeFill{
  height:100%;
  background:linear-gradient(90deg,#7b4dff,#9d6bff,#c59bff);
  border-radius:10px;
  box-shadow:0 0 10px rgba(160,120,255,.6);
}

/* ================= KNOBS ================= */
#progressKnob,#volumeKnob{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  width:14px;
  height:14px;
  border-radius:50%;
  background:#ffd7b0;
  box-shadow:0 0 10px rgba(255,176,120,.95),inset 0 0 4px rgba(255,255,255,.6);
}

#volumeKnob{
  background:#e9ddff;
  box-shadow:0 0 8px rgba(160,120,255,1);
}

/* ================= CLEAN ================= */
iframe,audio,video,canvas{background:transparent!important}
</style>

<div id="playerBox">

  <!-- TOP -->
  <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;width:100%;">

    <button id="playPauseBtn" style="
      width:32px;height:32px;border-radius:50%;
      background:linear-gradient(145deg,#ffb37a,#ff8a70);
      border:none;cursor:pointer;font-size:14px;
      box-shadow:0 0 8px rgba(255,176,120,.55);
    ">‚ñ∂</button>

    <!-- PROGRESS -->
    <div id="progressBar" style="flex:1.8;height:8px;">
      <div id="progressFilled" style="width:0%;position:relative;">
        <div id="progressKnob" style="right:-7px;"></div>
      </div>
    </div>

    <button id="loopBtn" style="
      width:30px;height:30px;border-radius:50%;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.15);
      cursor:pointer;font-size:14px;color:#fff;
    ">üîÅ</button>

    <div id="timeDisplay" style="
      min-width:80px;
      font-size:14px;
      font-weight:600;
      color:#fff;
      text-align:right;
    ">0:00 / 0:00</div>
  </div>

  <!-- VOLUME -->
  <div style="display:flex;align-items:center;justify-content:center;gap:6px;">
    <span id="cutIcon" style="font-size:16px;cursor:pointer;">üîä</span>

    <div id="volumeBar" style="width:110px;height:6px;">
      <div id="volumeFill" style="width:70%;"></div>
      <div id="volumeKnob" style="left:70%;"></div>
    </div>
  </div>

  <audio id="audioPlayer"
    src="https://cs1.mp3.pm/download/196179361/M0wyQ0lNU3lsSmcrcWVXSFZhSTFtTmZPTm9GL1VtLzMwNXNaZkpWU1FsTGdEcTNxcVFxVjd0dE1uM0dDdkx6Y0lxWk5tRDZqME5uR0NZa1NKeURsdTJZOTB1RVY3bFJlRWJ3UysyMXIvd0pvT21IY2doQ3UycWppcC9hYnc1Uzc/8D_TOP_MUSIC_-_Alan_Walker_-_Faded_(mp3.pm).mp3">
  </audio>
</div>

<script>
const audio = document.getElementById('audioPlayer');
const playBtn = document.getElementById('playPauseBtn');
const loopBtn = document.getElementById('loopBtn');
const cutIcon = document.getElementById('cutIcon');
const progressBar = document.getElementById('progressBar');
const progressFilled = document.getElementById('progressFilled');
const volumeBar = document.getElementById('volumeBar');
const volumeFill = document.getElementById('volumeFill');
const volumeKnob = document.getElementById('volumeKnob');
const timeDisplay = document.getElementById('timeDisplay');

/* ================= LOAD MEMORY ================= */
audio.volume = parseFloat(localStorage.getItem('musicVolume')) || 0.7;
audio.currentTime = parseFloat(localStorage.getItem('musicTime')) || 0;
audio.muted = localStorage.getItem('musicMuted') === 'true';
audio.loop = localStorage.getItem('musicLoop') === 'true';

const shouldPlay = localStorage.getItem('musicPlaying') === 'true';

/* ================= ICONS ================= */
function updateIcon(){
  cutIcon.textContent = (audio.muted || audio.volume===0) ? 'üîá' : 'üîä';
}
function updateLoopUI(){
  loopBtn.style.background = audio.loop
    ? 'linear-gradient(145deg,#ffb37a,#ff8a70)'
    : 'rgba(255,255,255,.08)';
}
updateIcon();
updateLoopUI();

/* ================= PLAY / PAUSE ================= */
playBtn.onclick = ()=>{
  audio.paused ? audio.play() : audio.pause();
};

audio.onplay = ()=>{
  playBtn.textContent='‚ùö‚ùö';
  localStorage.setItem('musicPlaying',true);
};

audio.onpause = ()=>{
  playBtn.textContent='‚ñ∂';
  localStorage.setItem('musicPlaying',false);
};

/* AUTO RESUME */
if(shouldPlay){
  audio.play().catch(()=>{});
}

/* ================= LOOP ================= */
loopBtn.onclick = ()=>{
  audio.loop = !audio.loop;
  localStorage.setItem('musicLoop',audio.loop);
  updateLoopUI();
};

/* ================= TIME ================= */
function formatTime(s){
  const m=Math.floor(s/60);
  const sec=Math.floor(s%60);
  return m+':'+(sec<10?'0':'')+sec;
}

audio.ontimeupdate=()=>{
  const p=(audio.currentTime/(audio.duration||1))*100;
  progressFilled.style.width=p+'%';
  timeDisplay.textContent =
    formatTime(audio.currentTime)+' / '+formatTime(audio.duration||0);
  localStorage.setItem('musicTime',audio.currentTime);
};

/* ================= SEEK (MOUSE + TOUCH) ================= */
function seek(e){
  const r=progressBar.getBoundingClientRect();
  const x=(e.touches?e.touches[0].clientX:e.clientX)-r.left;
  audio.currentTime=Math.max(0,Math.min(1,x/r.width))*audio.duration;
}
progressBar.onmousedown=e=>{
  seek(e);
  document.onmousemove=seek;
  document.onmouseup=()=>document.onmousemove=null;
};
progressBar.ontouchstart=seek;
progressBar.ontouchmove=seek;

/* ================= VOLUME ================= */
function setVolume(v){
  v=Math.max(0,Math.min(1,v));
  audio.volume=v;
  audio.muted=false;
  volumeFill.style.width=(v*100)+'%';
  volumeKnob.style.left=(v*100)+'%';
  localStorage.setItem('musicVolume',v);
  localStorage.setItem('musicMuted',false);
  updateIcon();
}

function volFromEvent(e){
  const r=volumeBar.getBoundingClientRect();
  const x=(e.touches?e.touches[0].clientX:e.clientX)-r.left;
  setVolume(x/r.width);
}

volumeBar.onmousedown=e=>{
  volFromEvent(e);
  document.onmousemove=volFromEvent;
  document.onmouseup=()=>document.onmousemove=null;
};
volumeBar.ontouchstart=volFromEvent;
volumeBar.ontouchmove=volFromEvent;

/* ================= MUTE ================= */
cutIcon.onclick=()=>{
  audio.muted=!audio.muted;
  localStorage.setItem('musicMuted',audio.muted);
  if(audio.muted){
    volumeFill.style.width='0%';
    volumeKnob.style.left='0%';
  }else setVolume(audio.volume||0.7);
  updateIcon();
};
</script>
